#addinバイナリファイルをソースファイルから作成する方法

= Excel =

== Office 2007より古いバージョン用 ==

以下のパスはC:\work\msofficesvn\へソースをチェックアウトした場合

ExcelSvn addinをアンインストールする

C:\work\msofficesvn\trunk\olderthan2007\addin\excelsvn\ImpExpCode.xls
を開く。

リボンの下に
セキュリティの警告 マクロが無効にされました。
と表示されるので、そのオプションボタンで、"このコンテンツを有効にする"を選択する。

Alt + F11 でVisual Basic Editorを起動する。

実行 | Sub/ユーザーフォームの実行を選択。

マクロ画面で、
日本語版の場合:ImportCodeJa
英語版の場合:ImportCodeEn
をそれぞれ選択し、実行する。ソースコードが読み込まれBook?が生成される。
ThisWorkbook.clsがノートパッドで開かれるので、

'------------------- Copy & paste from here to the ThisWorkbook module of excelsvn.xla --------------------

以下のコードを生成されたBook?のMicrosoft Excel Objects | ThisWorkbook へコピー＆ペーストする。

VBAProject(Book?)を選択し、デバッグ | VBAProjectのコンパイルを実行し、コンパイルする。

ファイル | Book?の上書き保存を選択する。名前を付けて保存画面が表示される。

ファイルの種類で、"Excel 97-2003 アドイン(*.xla)"を選択し、日本語版、英語版それぞれ、excelsvn.xlaというファイル名で保存する。

== Office 2007以降のバージョン用 ==

C:\work\msofficesvn\trunk\2007orlater\addin\excelsvn\ImpExpCode.xls
を開く。

Office 2007より古いバージョン用と同様に、ソースファイルからアドインファイルを作成する。

ファイルの種類は、"Excel アドイン(*.xlam)"を選択し、日本語版、英語版それぞれ、excelsvn.xlamというファイル名で保存する。

作成したexcelsvn.xlamをOffice 2007 Custom UI Editorで開き、

日本語版の場合

C:\work\msofficesvn\trunk\2007orlater\msofficesvn_common\src\customUI\ja\customUI.xml

の内容をCustom UIタブへ貼り付け保存する。ただし、これだと日本語部分が文字化けして、Excelへ組み込んだときにもリボンが表示されない。



= Word =