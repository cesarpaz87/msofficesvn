Wordのツールバーの前回の位置を記憶させて、Word起動時にそこに表示させられないか。

 * AutoExec()中でコマンドバーを削除しているコードをコメントアウトしても効果がなかった。
 * ExceのようなアプリケーションオブジェクトのインストールイベントはWordにはないのか?

Wordのアドイン中のSVNマクロに割り付けたショートカットキーは、一度アドインをアンインストールして、再度インストールすると、画面上はキーアサインされているように見えるが、実際には実行されない。いったんキーアサインを削除して、再登録すると実行されるようになる。

 * アドインプログラム中でショートカットキーもアサインできないか?
 * Wordはショートカットキーを使う場合が少なそうだが、Excelは多そう。不用意にショートカットキーを割り付けると、ユーザーが意図しない動作をさせてしまうことになる。Excelのデフォルトショートカットキー割当を要調査。

オブジェクトを生成する場所

 * 異なる文書やブックに対して、メソッドが並行して呼ばれるので、ActiveContentクラスは、メソッドローカルで生成、破棄すること。
 * Contentsクラスはモジュール変数で良いだろう。
 * FileSystemObjectはモジュール変数にしても大丈夫かな?
 * WScript.Shellはどうだろう?

MSOfficeのメモリ消費

 * Office97で、ExcelやWordで開いているファイルを閉じてもタスクマネージャで表示されるメモリ使用量がほどんど減らないことに気づいた。

   最小化すると減る。

-> Windowsアプリはだいたいそういうものらしい。

http://support.microsoft.com/?scid=kb%3Ben-us%3B293215&x=9&y=10

ファイル保存、オープン

 * ActiveWorkbook.Save でファイルがRead Onlyで上書きしてもエラーとならない。もちろん上書きはできていない。
  ->On Error Resume Nextのせいらしい。

 * ActiveWorkbook.Saveで、保存に問題があれば、それ以降の動作を中止する旨のメッセージを表示するべき。

 * そもそも読み取りのみ可のファイルで変更がある場合、どのように処理するべきか。
   + TSVNコマンドの実行を禁止する
     ファイルを開くと内容が変更されるファイルに対してコマンドが実行できなくなってしまう。
   + ユーザに、変更内容を破棄してコマンドを実行するか、コマンド実行をしないかを選択させる。

 * Wordのバージョンチェックのやり方は要検討。数値に変換して比較できるようにしたいが、数値しか入っていないという保証はない。Word97SR2では"8.0b"というバージョンが得られる。

PowerPoint97

 * PowerPointには、Excel,Wordのような、データファイルを作成するとデフォルトで生成される、ThisWorkbookクラスやThisDocumentクラスに相当するものは無いようである。アドインのインストール／アンインストールも標準モジュールを作成して、Auto_Open, Auto_Closeサブルーチンを追加するだけ。とりあえず、分かりやすいようにアドインをインストール／アンインストールする標準モジュール名をThisPresentationとした。

 * Presentation.Name はタイトルバーに表示される名前を返してくるようである。このタイトルバーに表示される名前は、ファイルの開き方(メニューから、ドラッグ＆ドロップで、エクスプローラ上でファイルをダブルクリックで、等）でなぜか拡張子が付いたり、付かなかったりする。したがって、Presentation.Nameを使ってファイルの有無をチェックするのは避けるべき。Excel,Wordではこのようなことはなさそう。

検討が必要な新規仕様

 * 削除コマンドもあると良い。リポジトリに反映するのにコミットが必要なコマンドなので、初心者には分かりにくいところがあるから。ツールバーは無しで、メニューのみの方が良いかな。英語版リリース後に追加しよう。

 * PowerPoint対応。でも、PowerPoint97しか持って無いので、他のバージョンでも動くかどうか確認できない。

 * 共有しないファイルは、更新、ロック取得、コミットなどのときに、いちいち閉じたくは無い。

 * AutoLock機能。共有しているファイルに対して編集をしようとしたら、ロック取得するかどうかを聞いてくれる機能(Visual Studio + Visual Source Safeのように)。

 * AutoAdd機能。特定の作業コピーフォルダへ保存すると、追加+コミットするかどうかを聞いてくれる機能(Visual Studio + Visual Source Safeのように)。

 * ロックモニタ。他人にロックされていたら、リポジトリのロック状況を監視してロックが開放されたら知らせて欲しい。Commit Monitorというソフトはあるが、ロックの状況までは監視してくれないみたい。作者に要望を出したら作ってくれるかな?